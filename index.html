<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finix</title>
    <meta name="theme-color" content="#121212"/>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <style>
        :root {
            --bg-color: #121212; --surface-color: #1e1e1e; --primary-color: #4CAF50;
            --secondary-color: #81C784; --text-color: #e0e0e0; --income-color: #66bb6a;
            --expense-color: #ef5350; --border-color: #333;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
       html, body { height: 100%; overflow: hidden; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: var(--bg-color); color: var(--text-color); display: flex; flex-direction: column; }
        main { flex-grow: 1; overflow: hidden; /* O container principal não rola mais */ display: flex; flex-direction: column; }
        button { padding: 12px 24px; border: none; border-radius: 8px; background-color: var(--primary-color); color: #fff; font-size: 1rem; cursor: pointer; transition: background-color 0.2s; font-weight: bold; }
        button:hover { background-color: #5a9e5e; }
        .button-secondary { background-color: transparent; border: 1px solid var(--primary-color); color: var(--primary-color); }
        .button-secondary:hover { background-color: rgba(76, 175, 80, 0.2); }
        /* --- UI Principal --- */
        .main-header { display: flex; justify-content: space-between; align-items: center; padding: 15px; }
        .main-header h2 { font-size: 1.2rem; color: var(--text-color); }
        .settings-button { background: none; border: none; padding: 8px; cursor: pointer; color: #aaa; }
        .settings-button:hover { color: #fff; }
        .settings-button svg { width: 24px; height: 24px; }
        #calendar-container { padding: 0 15px; flex-shrink: 0; /* Impede que o calendário encolha */ }
        #day-details-container { padding: 0 15px 15px 15px; flex-grow: 1; overflow-y: auto; /* Apenas a área de detalhes rola */ }
        .bottom-nav { position: relative; order: 2; width: 100%; background-color: var(--surface-color); display: flex; justify-content: space-around; padding: 10px 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.5); border-top: 1px solid var(--border-color); z-index: 998; }
        .nav-button { background: none; border: none; color: #aaa; display: flex; flex-direction: column; align-items: center; font-size: 0.75rem; padding: 5px; flex-grow: 1; }
        .nav-button.active { color: var(--primary-color); }
        .nav-button svg { width: 24px; height: 24px; margin-bottom: 4px; }
        .fab { position: fixed; bottom: 85px; right: 25px; width: 56px; height: 56px; background-color: var(--primary-color); border-radius: 50%; border: none; box-shadow: 0 6px 10px rgba(0,0,0,0.3); color: #fff; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: transform 0.2s ease; z-index: 999; }
        .fab:hover { transform: scale(1.05); }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow-y: auto; background-color: rgba(0,0,0,0.8); backdrop-filter: blur(5px); animation: fadeIn 0.3s ease; }
        .modal-content { background-color: var(--bg-color); margin: 0; width: 100%; min-height: 100%; border-radius: 0; display: flex; flex-direction: column; }
        .modal-header { position: relative; display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background-color: var(--surface-color); flex-shrink: 0; }
        .modal-body { padding: 20px; flex-grow: 1; overflow-y: auto; }

        .modal-title { font-size: 1.2rem; font-weight: 500; }
        .close-button { background: none; border: none; color: #aaa; font-size: 2rem; cursor: pointer; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        /* --- Componentes --- */
        .card { background-color: var(--surface-color); border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .card small a,
        .card small a:visited,
        .card small a:hover,
        .card small a:active {color: #aaa;   /* cinza claro */ text-decoration: none; /* opcional: tira o sublinhado */}
        .card small a:hover {color: #ccc;   /* um tom mais claro ao passar o mouse */}
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: #bbb; }
        .form-group input { width: 100%; padding: 12px; background-color: #333; border: 1px solid #444; border-radius: 8px; color: var(--text-color); font-size: 1rem; }
        .form-check { display: flex; align-items: center; gap: 10px; margin-bottom: 1rem; }
        .form-check input[type="checkbox"] { width: auto; }
        #recurring-fields { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        #recurring-fields.visible { max-height: 300px; }
        .calendar-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 0 5px; }
        .calendar-controls h2 { color: var(--secondary-color); font-size: 1.2rem; }
        .calendar-controls button { background: none; border: none; color: var(--secondary-color); font-size: 1.8rem; padding: 0 10px; cursor: pointer; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; }
        .calendar-header { text-align: center; font-size: 0.8em; color: #aaa; padding-bottom: 10px; }
        .calendar-day { background-color: transparent; border-radius: 8px; min-height: 60px; padding: 5px; font-size: 0.8em; display: flex; flex-direction: column; cursor: pointer; border: 2px solid transparent; transition: border-color 0.2s, background-color 0.2s; }
        .calendar-day.selected { border-color: var(--primary-color); }
        .day-number { text-align: center; }
        .day-summary { margin-top: auto; display: flex; justify-content: center; gap: 4px; }
        .day-dot { width: 6px; height: 6px; border-radius: 50%; }
        .day-dot.income { background-color: var(--income-color); }
        .day-dot.expense { background-color: var(--expense-color); }
        .transaction-list { list-style: none; padding: 0; }
        .transaction-item { display: flex; justify-content: space-between; padding: 15px 5px; border-bottom: 1px solid var(--border-color); align-items: center; gap: 10px; }
        .transaction-item:last-child { border-bottom: none; }
        .transaction-amount.income { color: var(--income-color); }
        .transaction-amount.expense { color: var(--expense-color); }
        .month-group-header { padding: 15px; background-color: #2a2a2a; border-radius: 8px; margin-top: 20px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .delete-btn, .delete-transaction-btn { background: none; border: none; color: #888; cursor: pointer; font-size: 1.2rem; padding: 5px; }
        /* --- Responsividade --- */
        @media (min-width: 768px) {
            .modal-content { width: 90%; max-width: 500px; min-height: auto; margin: 5% auto; border-radius: 12px; }
            .modal-header { position: relative; padding: 0 0 15px 0; background-color: transparent; }
        }
    </style>
</head>
<body>

    <main>
        <div class="main-header">
            <h2 id="main-title">Calendário</h2>
            <button id="btn-settings" class="settings-button" title="Configurações"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17-.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/></svg></button>
        </div>
        <div id="calendar-container"></div>
        <div id="day-details-container"></div>
    </main>
    <button class="fab" id="fab-add-tx" title="Adicionar Transação"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg></button>
    <footer class="bottom-nav">
        <button class="nav-button active" id="nav-calendar" title="Calendário"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 18H4V8h16v13z"/></svg>Calendário</button>
        <button class="nav-button" id="nav-transactions" title="Transações"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>Transações</button>
    </footer>
    <div id="modal-container"></div>

    <template id="calendar-day-template"><div class="calendar-day" role="button" tabindex="0"><div class="day-number"></div><div class="day-summary"></div></div></template>
    <template id="day-details-template"><div class="card"><div class="day-details-header"><h3 class="day-details-title"></h3><p class="day-details-summary"></p></div><ul class="transaction-list"></ul></div></template>
    <template id="transaction-item-template"><li class="transaction-item"><div class="transaction-details"><p class="transaction-description"></p></div><div class="transaction-amount"></div><button class="delete-transaction-btn" title="Excluir Transação">&times;</button></li></template>
    <template id="recurring-item-template"><li class="transaction-item"><div class="transaction-details"><span class="recurring-description"></span><small class="recurring-end-date"></small></div><div class="transaction-amount"></div><button class="delete-btn" title="Excluir Regra Recorrente">&times;</button></li></template>
    <template id="modal-template"><div class="modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title"></h2><button class="close-button">&times;</button></div><div class="modal-body"></div></div></div></template>

    <script src="main.js"></script>
</body>
</html>
